(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{46:function(e,t,s){e.exports=s(73)},55:function(e,t,s){},73:function(e,t,s){"use strict";s.r(t);var r=s(1),n=s.n(r),a=s(39),o=s(6),i=s(14),u=s(43),l=(s(55),s(19)),g=s(20),p=s(26),c=s(21),d=s(9),m=s(27),f=s(22),h=s.n(f),v=s(15),y=function(e){function t(e){var s;return Object(l.a)(this,t),(s=Object(p.a)(this,Object(c.a)(t).call(this,e))).state={loading:!0,result:"",trigger:!1},s.triggetNext=s.triggetNext.bind(Object(d.a)(s)),s}return Object(m.a)(t,e),Object(g.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props,s=t.steps[t.fromStep].value;console.log("DialogFlowGateway > componentWillMount"+s);var r=new XMLHttpRequest;r.addEventListener("readystatechange",function(){if(4===this.readyState){var t=JSON.parse(this.responseText);console.log("data object in readyStateChange:"),console.log(t),e.setState({loading:!1,result:"..."});var s=t.queryResult.intent.displayName;if("ReadLocationFromFirestore"===s){console.log("output context:"),console.log(t.queryResult.outputContexts.length>0?t.queryResult.outputContexts[0].name+JSON.stringify(t.queryResult.outputContexts[0].parameters):"no output contexts");var r=t.queryResult.fulfillmentMessages;n({value:{messages:r.map(function(e,t){return e.text.text[0]})},trigger:"printAll"})}else if("ReadHospitalFromFireStore"===s){console.log("output context:"),console.log(t.queryResult.outputContexts.length>0?t.queryResult.outputContexts[0].name+JSON.stringify(t.queryResult.outputContexts[0].parameters):"no output contexts");var a=t.queryResult.fulfillmentMessages;n({value:{hospitalsMsg:a.map(function(e,t){return e.text.text[0]})},trigger:"listHospInCluster"})}else n({value:{p1:"hi",p2:"bye"},trigger:"step4"})}});var n=e.props.triggerNextStep;r.open("POST","https://dialogflow.googleapis.com/v2beta1/projects/geek-ha-hmbsib/agent/sessions/123456788:detectIntent"),r.setRequestHeader("Authorization","Bearer "+new URLSearchParams(window.location.search).get("apiKey")),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify({query_input:{text:{text:s,language_code:"en-US"}}}))}},{key:"triggetNext",value:function(){var e=this;this.setState({trigger:!0},function(){e.props.triggerNextStep()})}},{key:"render",value:function(){var e=this,t=this.state,s=t.trigger,r=t.loading,a=t.result;return n.a.createElement("div",{className:"DialogFlowGateway"},r?n.a.createElement(f.Loading,null):a,!r&&n.a.createElement("div",{style:{textAlign:"center",marginTop:20}},!s&&n.a.createElement("button",{onClick:function(){return e.triggetNext()}},"Search Again")))}}]),t}(r.Component);y.defaultProps={steps:void 0,triggerNextStep:void 0};var w=function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){this.props.doSomething;var e=[{id:"start",message:"Hello HADO, this is Mass Casualty Incident bot. Where did it happen?",trigger:"userInput"},{id:"userInput",trigger:"dialogFlowGateway1",user:!0},{id:"confirmHosp",message:function(e){e.previousValue;return"Please type "+e.steps.dialogFlowGateway1.value.hospital+" to confirm"},trigger:"userInputHosp"},{id:"userInputHosp",trigger:"dialogFlowGateway2",user:!0},{id:"cluster",message:"Hospitals in KCC:",trigger:"qeh"},{id:"qeh",asMessage:!0,component:n.a.createElement("div",null,"QEH:",n.a.createElement("br",null),"Red Quota: 2+2",n.a.createElement("br",null),"Yellow + Green Quota: 12",n.a.createElement("br",null),"Estimated traffic time: 2 minutes"),trigger:"kwh"},{id:"kwh",asMessage:!0,component:n.a.createElement("div",null,"KWH:",n.a.createElement("br",null),"Red Quota: 2+2",n.a.createElement("br",null),"Yellow + Green Quota: 12",n.a.createElement("br",null),"Estimated traffic time: 5 minutes"),trigger:"burn"},{id:"burn",message:"Are there any burn cases?",trigger:"userInputBurn"},{id:"userInputBurn",trigger:"yesBurn",user:!0},{id:"yesBurn",message:"Hospitals with Burn Units: QMH, PWH\nHospitals with Burn Facilities: QEH, KWH, TMH",trigger:"poison"},{id:"poison",message:"Are there any poison cases?",trigger:"userInputPoison"},{id:"userInputPoison",trigger:"yesPoison",user:!0},{id:"yesPoison",message:"Please be reminded to notify Hong Kong Poison Information Centre (HKPIC)",end:!0},{id:"step1",message:"Reply step1",trigger:"start"},{id:"step2",message:function(e){e.previousValue,e.steps;return(new Date).toString()},trigger:"start"},{id:"printAll",message:function(e){var t=e.previousValue;e.steps;return t.messages[0]},trigger:"hosp1"},{id:"hosp1",message:function(e){e.previousValue;return e.steps.dialogFlowGateway1.value.messages[1]},trigger:"hosp2"},{id:"hosp2",message:function(e){e.previousValue;return e.steps.dialogFlowGateway1.value.messages[2]},trigger:"hosp3"},{id:"hosp3",message:function(e){e.previousValue;return e.steps.dialogFlowGateway1.value.messages[3]},trigger:"burn"},{id:"foundAddress",message:function(e){var t=e.previousValue;e.steps;return t.addressMsg},trigger:"nearestHosp"},{id:"nearestHosp",message:function(e){e.previousValue;return e.steps.dialogFlowGateway1.value.hospitalMsg},trigger:"confirmHosp"},{id:"listHospInCluster",message:function(e){e.previousValue;return e.steps.dialogFlowGateway2.value.hospitalsMsg[0]},trigger:"listHospInCluster1"},{id:"listHospInCluster1",message:function(e){e.previousValue;return e.steps.dialogFlowGateway2.value.hospitalsMsg[1]},trigger:"listHospInCluster2"},{id:"listHospInCluster2",message:function(e){e.previousValue;return e.steps.dialogFlowGateway2.value.hospitalsMsg[2]},trigger:"burn"},{id:"step4",message:function(e){var t=e.previousValue;e.steps;return console.log(JSON.stringify(t)),"Sorry, I do not understand"},trigger:"start"},{id:"dialogFlowGateway1",component:n.a.createElement(y,{fromStep:"userInput"}),waitAction:!0,replace:!0,trigger:"userInput"},{id:"dialogFlowGateway2",component:n.a.createElement(y,{fromStep:"userInputHosp"}),waitAction:!0,replace:!0,trigger:"userInput"}];return n.a.createElement("div",null,n.a.createElement(v.ThemeProvider,{theme:{background:"#f5f8fb",fontFamily:"Helvetica Neue",headerBgColor:"#EF6C00",headerFontColor:"#fff",headerFontSize:"15px",botBubbleColor:"#EF6C00",botFontColor:"#fff",userBubbleColor:"#fff",userFontColor:"#4a4a4a"}},n.a.createElement(h.a,{steps:e,botDelay:500,customDelay:100,userDelay:100,headerTitle:"Geek Bot",hideUserAvatar:!0})))}}]),t}(r.Component),b=Object(i.b)(function(e){return{}},function(e){return{doSomething:function(e){return console.log(e)}}})(w),H=(s(16),{messages:[{id:"start",message:"Hello HADO, this is Mass Casualty Incident bot. Where did it happen?",trigger:"userInput"},{id:"userInput",trigger:"dialogFlowGateway",user:!0},{id:"step1",message:"Reply step1",trigger:"start"},{id:"step2",message:function(e){e.previousValue,e.steps;return(new Date).toString()},trigger:"start"},{id:"foundAddress",message:function(e){var t=e.previousValue;e.steps;return"It is "+t.address+"."},trigger:"nearestHosp"},{id:"nearestHosp",message:function(e){e.previousValue;return"The nearest hospital is "+e.steps.dialogFlowGateway.value.hospital},trigger:"listHospInCluster"},{id:"listHospInCluster",message:function(e){e.previousValue;return"Hospitals in "+e.steps.dialogFlowGateway.value.cluster},end:!0},{id:"step4",message:function(e){var t=e.previousValue;e.steps;return console.log(JSON.stringify(t)),"step4"},trigger:"start"}],userIdx:1,nextid:4}),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H;switch((arguments.length>1?arguments[1]:void 0).type){case"ADD_USER_MESSAGE":default:return e}},E=Object(o.c)({ChatState:C}),S=s(12),I=s.n(S),O=(s(25),I.a.mark(x));function x(){return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},O)}var F=x,G=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d,R=Object(u.a)(),j=Object(o.e)(E,G(Object(o.a)(R)));R.run(F),Object(a.render)(n.a.createElement(i.a,{store:j},n.a.createElement(b,null)),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.f1ccbd2c.chunk.js.map
